function yprime=mymode1(t,q)
global g a b l
g=9.8;
a=2.85;
b=1.1;
l=1.4;
m11=392;
m12=1093;
m13=1015;
m21=1566;
m22=4374;
m23=4060;
m31=392;
m32=1093;
m33=1015;
mf1=71;
mf2=38;
mf3=71;
mr1=116;
mr2=96;
mr3=116;
c11=40000;
c13=4000;
c31=40000;
c33=4000;
cf1=3500;
cf3=3500;
cr1=12600;
cr3=12600;
k11=251000;
k13=1000000;
k31=251000;
k33=1000000;
kf1=1100000;
kf3=1100000;
kr1=4400000;
kr3=4400000;
M=[m11 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 m12 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 m13 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 m21 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 m22 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 m23 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 m31 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 m32 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 m33 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 mf1 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 mf2 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 mf3 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 mr1 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 mr2 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 mr3];%质量
c=[c11 0 0 0 0 0 0 0 0 -c11 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 c13 0 0 0 0 0 0 0 0 0 -c13 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 c31 0 0 0 0 -c31 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 c33 0 0 0 0 0 -c33;
   -c11 0 0 0 0 0 0 0 0 c11+cf1 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 -c31 0 0 0 0 c31+cf3 0 0 0;
   0 0 -c13 0 0 0 0 0 0 0 0 0 c13+cr1 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 -c33 0 0 0 0 0 c33+cr3];%阻尼
k=[k11 0 0 0 0 0 0 0 0 -k11 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 k13 0 0 0 0 0 0 0 0 0 -k13 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 k31 0 0 0 0 -k31 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 k33 0 0 0 0 0 -k33;
   -k11 0 0 0 0 0 0 0 0 k11+kf1 0 0 0 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 -k31 0 0 0 0 k31+kf3 0 0 0;
   0 0 -k13 0 0 0 0 0 0 0 0 0 k13+kr1 0 0;
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
   0 0 0 0 0 0 0 0 -k33 0 0 0 0 0 k33+kr3];%刚度
uf1d=cos(10*t);
uf1=0.1*sin(10*t);
ur1d=cos(10*t-3.95);
ur1=0.1*sin(10*t-3.95);
uf3d=cos(10*t);
uf3=0.1*sin(10*t);
ur3d=cos(10*t-3.95);
ur3=0.1*sin(10*t-3.95);
%q=[z11;z12;z13;z21;z22;z23;z31;z32;z33;zf1;zf2;zf3;zr1;zr2;zr3];%自由度
bb=[-m11*g;-m12*g;-m13*g;-m21*g;-m22*g;-m23*g;-m31*g;-m32*g;-m33*g;
   -mf1*g+cf1*uf1d+kf1*uf1;-mf2*g;-mf3*g+cf3*uf3d+kf3*uf3;
   -mr1*g+cr1*ur1d+kr1*ur1;-mr2*g;-mr3*g+cr3*ur3d+kr3*ur3];%无约束方程常数项

aa=[1/2 0 0 -1 0 0 1/2 0 0 0 0 0 0 0 0;
    b/(a+b) -1 a/(a+b) 0 0 0 0 0 0 0 0 0 0 0 0;
    -1 0 1 0 0 0 1 0 -1 0 0 0 0 0 0;
    -1/2 0 1 0 0 -1 1/2 0 0 0 0 0 0 0 0;
    -a/(a+b) 0 a/(a+b) 0 0 0 1 -1 0 0 0 0 0 0 0;
    -(a-b)/(2*(a+b)) 0 a/(a+b) 0 -1 0 1/2 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 1/2 -1 1/2 0 0 0;
    0 0 0 0 0 0 0 0 0 0 0 0 1/2 -1 1/2];%约束矩阵

yprim(1)=q(16);
yprim(2)=q(17);
yprim(3)=q(18);
yprim(4)=q(19);
yprim(5)=q(20);
yprim(6)=q(21);
yprim(7)=q(22);
yprim(8)=q(23);
yprim(9)=q(24);
yprim(10)=q(25);
yprim(11)=q(26);
yprim(12)=q(27);
yprim(13)=q(28);
yprim(14)=q(29);
yprim(15)=q(30);
qd=[q(16) q(17) q(18) q(19) q(20) q(21) q(22) q(23) q(24) q(25) q(26) q(27) q(28) q(29) q(30)]';
q1=[q(1) q(2) q(3) q(4) q(5) q(6) q(7) q(8) q(9) q(10) q(11) q(12) q(13) q(14) q(15)]';
qq=bb-c*qd-k*q1;%主动力矩阵
M2 = M^(-1/2);
acc=M^(-1)*qq;
er=-aa*acc;
B=aa*M2;
xxz=acc+M2*pinv(B)*er;
yprim(16)=xxz(1);
yprim(17)=xxz(2);
yprim(18)=xxz(3);
yprim(19)=xxz(4);
yprim(20)=xxz(5);
yprim(21)=xxz(6);
yprim(22)=xxz(7);
yprim(23)=xxz(8);
yprim(24)=xxz(9);
yprim(25)=xxz(10);
yprim(26)=xxz(11);
yprim(27)=xxz(12);
yprim(28)=xxz(13);
yprim(29)=xxz(14);
yprim(30)=xxz(15);
yprime=yprim';